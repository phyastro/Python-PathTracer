import taichi as ti
import taichi.math as tm


# Table
# https://cie.co.at/datatable/cie-1964-colour-matching-functions-10-degree-observer
CIE1964XYZ_list = [
    tm.vec3(0.0000001222, 0.000000013398, 0.000000535027), #360 nm
    tm.vec3(0.000000185138, 0.000000020294, 0.00000081072), #361 nm
    tm.vec3(0.00000027883, 0.00000003056, 0.0000012212), #362 nm
    tm.vec3(0.00000041747, 0.00000004574, 0.0000018287), #363 nm
    tm.vec3(0.00000062133, 0.00000006805, 0.0000027222), #364 nm
    tm.vec3(0.00000091927, 0.00000010065, 0.0000040283), #365 nm
    tm.vec3(0.00000135198, 0.00000014798, 0.0000059257), #366 nm
    tm.vec3(0.00000197654, 0.00000021627, 0.0000086651), #367 nm
    tm.vec3(0.0000028725, 0.0000003142, 0.000012596), #368 nm
    tm.vec3(0.0000041495, 0.0000004537, 0.000018201), #369 nm
    tm.vec3(0.0000059586, 0.0000006511, 0.0000261437), #370 nm
    tm.vec3(0.0000085056, 0.0000009288, 0.00003733), #371 nm
    tm.vec3(0.0000120686, 0.0000013175, 0.000052987), #372 nm
    tm.vec3(0.0000170226, 0.0000018572, 0.000074764), #373 nm
    tm.vec3(0.000023868, 0.000002602, 0.00010487), #374 nm
    tm.vec3(0.000033266, 0.000003625, 0.00014622), #375 nm
    tm.vec3(0.000046087, 0.000005019, 0.00020266), #376 nm
    tm.vec3(0.000063472, 0.000006907, 0.00027923), #377 nm
    tm.vec3(0.000086892, 0.000009449, 0.00038245), #378 nm
    tm.vec3(0.000118246, 0.000012848, 0.00052072), #379 nm
    tm.vec3(0.000159952, 0.000017364, 0.000704776), #380 nm
    tm.vec3(0.00021508, 0.000023327, 0.00094823), #381 nm
    tm.vec3(0.00028749, 0.00003115, 0.0012682), #382 nm
    tm.vec3(0.00038199, 0.00004135, 0.0016861), #383 nm
    tm.vec3(0.00050455, 0.00005456, 0.0022285), #384 nm
    tm.vec3(0.00066244, 0.00007156, 0.0029278), #385 nm
    tm.vec3(0.0008645, 0.0000933, 0.0038237), #386 nm
    tm.vec3(0.0011215, 0.00012087, 0.0049642), #387 nm
    tm.vec3(0.00144616, 0.00015564, 0.0064067), #388 nm
    tm.vec3(0.00185359, 0.0001992, 0.0082193), #389 nm
    tm.vec3(0.0023616, 0.0002534, 0.0104822), #390 nm
    tm.vec3(0.0029906, 0.0003202, 0.013289), #391 nm
    tm.vec3(0.0037645, 0.0004024, 0.016747), #392 nm
    tm.vec3(0.0047102, 0.0005023, 0.02098), #393 nm
    tm.vec3(0.0058581, 0.0006232, 0.026127), #394 nm
    tm.vec3(0.0072423, 0.0007685, 0.032344), #395 nm
    tm.vec3(0.0088996, 0.0009417, 0.039802), #396 nm
    tm.vec3(0.0108709, 0.0011478, 0.048691), #397 nm
    tm.vec3(0.0131989, 0.0013903, 0.05921), #398 nm
    tm.vec3(0.0159292, 0.001674, 0.071576), #399 nm
    tm.vec3(0.0191097, 0.0020044, 0.0860109), #400 nm
    tm.vec3(0.022788, 0.002386, 0.10274), #401 nm
    tm.vec3(0.027011, 0.002822, 0.122), #402 nm
    tm.vec3(0.031829, 0.003319, 0.14402), #403 nm
    tm.vec3(0.037278, 0.00388, 0.16899), #404 nm
    tm.vec3(0.0434, 0.004509, 0.19712), #405 nm
    tm.vec3(0.050223, 0.005209, 0.22857), #406 nm
    tm.vec3(0.057764, 0.005985, 0.26347), #407 nm
    tm.vec3(0.066038, 0.006833, 0.3019), #408 nm
    tm.vec3(0.075033, 0.007757, 0.34387), #409 nm
    tm.vec3(0.084736, 0.008756, 0.389366), #410 nm
    tm.vec3(0.095041, 0.009816, 0.43797), #411 nm
    tm.vec3(0.105836, 0.010918, 0.48922), #412 nm
    tm.vec3(0.117066, 0.012058, 0.5429), #413 nm
    tm.vec3(0.128682, 0.013237, 0.59881), #414 nm
    tm.vec3(0.140638, 0.014456, 0.65676), #415 nm
    tm.vec3(0.152893, 0.015717, 0.71658), #416 nm
    tm.vec3(0.165416, 0.017025, 0.77812), #417 nm
    tm.vec3(0.178191, 0.018399, 0.84131), #418 nm
    tm.vec3(0.191214, 0.019848, 0.90611), #419 nm
    tm.vec3(0.204492, 0.021391, 0.972542), #420 nm
    tm.vec3(0.21765, 0.022992, 1.0389), #421 nm
    tm.vec3(0.230267, 0.024598, 1.1031), #422 nm
    tm.vec3(0.242311, 0.026213, 1.1651), #423 nm
    tm.vec3(0.253793, 0.027841, 1.2249), #424 nm
    tm.vec3(0.264737, 0.029497, 1.2825), #425 nm
    tm.vec3(0.275195, 0.031195, 1.3382), #426 nm
    tm.vec3(0.285301, 0.032927, 1.3926), #427 nm
    tm.vec3(0.295143, 0.034738, 1.4461), #428 nm
    tm.vec3(0.304869, 0.036654, 1.4994), #429 nm
    tm.vec3(0.314679, 0.038676, 1.55348), #430 nm
    tm.vec3(0.324355, 0.040792, 1.6072), #431 nm
    tm.vec3(0.33357, 0.042946, 1.6589), #432 nm
    tm.vec3(0.342243, 0.045114, 1.7082), #433 nm
    tm.vec3(0.350312, 0.047333, 1.7548), #434 nm
    tm.vec3(0.357719, 0.049602, 1.7985), #435 nm
    tm.vec3(0.364482, 0.051934, 1.8392), #436 nm
    tm.vec3(0.370493, 0.054337, 1.8766), #437 nm
    tm.vec3(0.375727, 0.056822, 1.9105), #438 nm
    tm.vec3(0.380158, 0.059399, 1.9408), #439 nm
    tm.vec3(0.383734, 0.062077, 1.96728), #440 nm
    tm.vec3(0.386327, 0.064737, 1.9891), #441 nm
    tm.vec3(0.387858, 0.067285, 2.0057), #442 nm
    tm.vec3(0.388396, 0.069764, 2.0174), #443 nm
    tm.vec3(0.387978, 0.072218, 2.0244), #444 nm
    tm.vec3(0.386726, 0.074704, 2.0273), #445 nm
    tm.vec3(0.384696, 0.077272, 2.0264), #446 nm
    tm.vec3(0.382006, 0.079979, 2.0223), #447 nm
    tm.vec3(0.378709, 0.082874, 2.0153), #448 nm
    tm.vec3(0.374915, 0.086, 2.006), #449 nm
    tm.vec3(0.370702, 0.089456, 1.9948), #450 nm
    tm.vec3(0.366089, 0.092947, 1.9814), #451 nm
    tm.vec3(0.361045, 0.096275, 1.9653), #452 nm
    tm.vec3(0.355518, 0.099535, 1.9464), #453 nm
    tm.vec3(0.349486, 0.102829, 1.9248), #454 nm
    tm.vec3(0.342957, 0.106256, 1.9007), #455 nm
    tm.vec3(0.335893, 0.109901, 1.8741), #456 nm
    tm.vec3(0.328284, 0.113835, 1.8451), #457 nm
    tm.vec3(0.32015, 0.118167, 1.8139), #458 nm
    tm.vec3(0.311475, 0.122932, 1.7806), #459 nm
    tm.vec3(0.302273, 0.128201, 1.74537), #460 nm
    tm.vec3(0.292858, 0.133457, 1.7091), #461 nm
    tm.vec3(0.283502, 0.138323, 1.6723), #462 nm
    tm.vec3(0.274044, 0.143042, 1.6347), #463 nm
    tm.vec3(0.264263, 0.147787, 1.5956), #464 nm
    tm.vec3(0.254085, 0.152761, 1.5549), #465 nm
    tm.vec3(0.243392, 0.158102, 1.5122), #466 nm
    tm.vec3(0.232187, 0.163941, 1.4673), #467 nm
    tm.vec3(0.220488, 0.170362, 1.4199), #468 nm
    tm.vec3(0.208198, 0.177425, 1.37), #469 nm
    tm.vec3(0.195618, 0.18519, 1.31756), #470 nm
    tm.vec3(0.183034, 0.193025, 1.2624), #471 nm
    tm.vec3(0.170222, 0.200313, 1.205), #472 nm
    tm.vec3(0.157348, 0.207156, 1.1466), #473 nm
    tm.vec3(0.14465, 0.213644, 1.088), #474 nm
    tm.vec3(0.132349, 0.21994, 1.0302), #475 nm
    tm.vec3(0.120584, 0.22617, 0.97383), #476 nm
    tm.vec3(0.109456, 0.232467, 0.91943), #477 nm
    tm.vec3(0.099042, 0.239025, 0.86746), #478 nm
    tm.vec3(0.089388, 0.245997, 0.81828), #479 nm
    tm.vec3(0.080507, 0.253589, 0.772125), #480 nm
    tm.vec3(0.072034, 0.261876, 0.72829), #481 nm
    tm.vec3(0.06371, 0.270643, 0.68604), #482 nm
    tm.vec3(0.055694, 0.279645, 0.64553), #483 nm
    tm.vec3(0.048117, 0.288694, 0.60685), #484 nm
    tm.vec3(0.041072, 0.297665, 0.57006), #485 nm
    tm.vec3(0.034642, 0.306469, 0.53522), #486 nm
    tm.vec3(0.028896, 0.315035, 0.50234), #487 nm
    tm.vec3(0.023876, 0.323335, 0.4714), #488 nm
    tm.vec3(0.019628, 0.331366, 0.44239), #489 nm
    tm.vec3(0.016172, 0.339133, 0.415254), #490 nm
    tm.vec3(0.0133, 0.34786, 0.390024), #491 nm
    tm.vec3(0.010759, 0.358326, 0.366399), #492 nm
    tm.vec3(0.008542, 0.370001, 0.344015), #493 nm
    tm.vec3(0.006661, 0.382464, 0.322689), #494 nm
    tm.vec3(0.005132, 0.395379, 0.302356), #495 nm
    tm.vec3(0.003982, 0.408482, 0.283036), #496 nm
    tm.vec3(0.003239, 0.421588, 0.264816), #497 nm
    tm.vec3(0.002934, 0.434619, 0.247848), #498 nm
    tm.vec3(0.003114, 0.447601, 0.232318), #499 nm
    tm.vec3(0.003816, 0.460777, 0.218502), #500 nm
    tm.vec3(0.005095, 0.47434, 0.205851), #501 nm
    tm.vec3(0.006936, 0.4882, 0.193596), #502 nm
    tm.vec3(0.009299, 0.50234, 0.181736), #503 nm
    tm.vec3(0.012147, 0.51674, 0.170281), #504 nm
    tm.vec3(0.015444, 0.53136, 0.159249), #505 nm
    tm.vec3(0.019156, 0.54619, 0.148673), #506 nm
    tm.vec3(0.02325, 0.56118, 0.138609), #507 nm
    tm.vec3(0.02769, 0.57629, 0.129096), #508 nm
    tm.vec3(0.032444, 0.5915, 0.120215), #509 nm
    tm.vec3(0.037465, 0.606741, 0.112044), #510 nm
    tm.vec3(0.042956, 0.62215, 0.10471), #511 nm
    tm.vec3(0.049114, 0.63783, 0.098196), #512 nm
    tm.vec3(0.05592, 0.65371, 0.092361), #513 nm
    tm.vec3(0.063349, 0.66968, 0.087088), #514 nm
    tm.vec3(0.071358, 0.68566, 0.082248), #515 nm
    tm.vec3(0.079901, 0.70155, 0.077744), #516 nm
    tm.vec3(0.088909, 0.71723, 0.073456), #517 nm
    tm.vec3(0.098293, 0.73257, 0.069268), #518 nm
    tm.vec3(0.107949, 0.74746, 0.06506), #519 nm
    tm.vec3(0.117749, 0.761757, 0.060709), #520 nm
    tm.vec3(0.127839, 0.77534, 0.056457), #521 nm
    tm.vec3(0.13845, 0.78822, 0.052609), #522 nm
    tm.vec3(0.149516, 0.80046, 0.049122), #523 nm
    tm.vec3(0.161041, 0.81214, 0.045954), #524 nm
    tm.vec3(0.172953, 0.82333, 0.04305), #525 nm
    tm.vec3(0.185209, 0.83412, 0.040368), #526 nm
    tm.vec3(0.197755, 0.8446, 0.037839), #527 nm
    tm.vec3(0.210538, 0.85487, 0.035384), #528 nm
    tm.vec3(0.22346, 0.86504, 0.032949), #529 nm
    tm.vec3(0.236491, 0.875211, 0.030451), #530 nm
    tm.vec3(0.249633, 0.88537, 0.028029), #531 nm
    tm.vec3(0.262972, 0.89537, 0.025862), #532 nm
    tm.vec3(0.276515, 0.90515, 0.02392), #533 nm
    tm.vec3(0.290269, 0.91465, 0.022174), #534 nm
    tm.vec3(0.304213, 0.92381, 0.020584), #535 nm
    tm.vec3(0.318361, 0.93255, 0.019127), #536 nm
    tm.vec3(0.332705, 0.94081, 0.01774), #537 nm
    tm.vec3(0.347232, 0.94852, 0.016403), #538 nm
    tm.vec3(0.361926, 0.9556, 0.015064), #539 nm
    tm.vec3(0.376772, 0.961988, 0.013676), #540 nm
    tm.vec3(0.391683, 0.96754, 0.012308), #541 nm
    tm.vec3(0.406594, 0.97223, 0.011056), #542 nm
    tm.vec3(0.421539, 0.97617, 0.009915), #543 nm
    tm.vec3(0.436517, 0.97946, 0.008872), #544 nm
    tm.vec3(0.451584, 0.9822, 0.007918), #545 nm
    tm.vec3(0.466782, 0.98452, 0.00703), #546 nm
    tm.vec3(0.482147, 0.98652, 0.006223), #547 nm
    tm.vec3(0.497738, 0.98832, 0.005453), #548 nm
    tm.vec3(0.513606, 0.99002, 0.004714), #549 nm
    tm.vec3(0.529826, 0.991761, 0.003988), #550 nm
    tm.vec3(0.54644, 0.99353, 0.003289), #551 nm
    tm.vec3(0.563426, 0.99523, 0.002646), #552 nm
    tm.vec3(0.580726, 0.99677, 0.002063), #553 nm
    tm.vec3(0.59829, 0.99809, 0.001533), #554 nm
    tm.vec3(0.616053, 0.99911, 0.001091), #555 nm
    tm.vec3(0.633948, 0.99977, 0.000711), #556 nm
    tm.vec3(0.651901, 1, 0.000407), #557 nm
    tm.vec3(0.669824, 0.99971, 0.000184), #558 nm
    tm.vec3(0.687632, 0.99885, 0.000047), #559 nm
    tm.vec3(0.705224, 0.99734, 0), #560 nm
    tm.vec3(0.722773, 0.99526, 0), #561 nm
    tm.vec3(0.740483, 0.99274, 0), #562 nm
    tm.vec3(0.758273, 0.98975, 0), #563 nm
    tm.vec3(0.776083, 0.9863, 0), #564 nm
    tm.vec3(0.793832, 0.98238, 0), #565 nm
    tm.vec3(0.811436, 0.97798, 0), #566 nm
    tm.vec3(0.828822, 0.97311, 0), #567 nm
    tm.vec3(0.845879, 0.96774, 0), #568 nm
    tm.vec3(0.862525, 0.96189, 0), #569 nm
    tm.vec3(0.878655, 0.955552, 0), #570 nm
    tm.vec3(0.894208, 0.948601, 0), #571 nm
    tm.vec3(0.909206, 0.940981, 0), #572 nm
    tm.vec3(0.923672, 0.932798, 0), #573 nm
    tm.vec3(0.937638, 0.924158, 0), #574 nm
    tm.vec3(0.951162, 0.915175, 0), #575 nm
    tm.vec3(0.964283, 0.905954, 0), #576 nm
    tm.vec3(0.977068, 0.896608, 0), #577 nm
    tm.vec3(0.98959, 0.887249, 0), #578 nm
    tm.vec3(1.00191, 0.87799, 0), #579 nm
    tm.vec3(1.01416, 0.86893, 0), #580 nm
    tm.vec3(1.0265, 0.86016, 0), #581 nm
    tm.vec3(1.0388, 0.85152, 0), #582 nm
    tm.vec3(1.051, 0.84296, 0), #583 nm
    tm.vec3(1.0629, 0.83439, 0), #584 nm
    tm.vec3(1.0743, 0.82562, 0), #585 nm
    tm.vec3(1.0852, 0.81676, 0), #586 nm
    tm.vec3(1.0952, 0.80754, 0), #587 nm
    tm.vec3(1.1042, 0.79795, 0), #588 nm
    tm.vec3(1.112, 0.78789, 0), #589 nm
    tm.vec3(1.11852, 0.77741, 0), #590 nm
    tm.vec3(1.1238, 0.76649, 0), #591 nm
    tm.vec3(1.128, 0.75531, 0), #592 nm
    tm.vec3(1.1311, 0.74385, 0), #593 nm
    tm.vec3(1.1332, 0.73219, 0), #594 nm
    tm.vec3(1.1343, 0.72035, 0), #595 nm
    tm.vec3(1.1343, 0.70828, 0), #596 nm
    tm.vec3(1.1333, 0.69606, 0), #597 nm
    tm.vec3(1.1312, 0.68362, 0), #598 nm
    tm.vec3(1.1281, 0.67105, 0), #599 nm
    tm.vec3(1.12399, 0.65834, 0), #600 nm
    tm.vec3(1.1189, 0.64555, 0), #601 nm
    tm.vec3(1.1129, 0.63272, 0), #602 nm
    tm.vec3(1.1059, 0.61982, 0), #603 nm
    tm.vec3(1.098, 0.60689, 0), #604 nm
    tm.vec3(1.0891, 0.59388, 0), #605 nm
    tm.vec3(1.0792, 0.58078, 0), #606 nm
    tm.vec3(1.0684, 0.56765, 0), #607 nm
    tm.vec3(1.0567, 0.55449, 0), #608 nm
    tm.vec3(1.044, 0.54123, 0), #609 nm
    tm.vec3(1.03048, 0.52796, 0), #610 nm
    tm.vec3(1.016, 0.51463, 0), #611 nm
    tm.vec3(1.0008, 0.50136, 0), #612 nm
    tm.vec3(0.98479, 0.488124, 0), #613 nm
    tm.vec3(0.96808, 0.474935, 0), #614 nm
    tm.vec3(0.95074, 0.461834, 0), #615 nm
    tm.vec3(0.9328, 0.448823, 0), #616 nm
    tm.vec3(0.91434, 0.435917, 0), #617 nm
    tm.vec3(0.89539, 0.423153, 0), #618 nm
    tm.vec3(0.87603, 0.410526, 0), #619 nm
    tm.vec3(0.856297, 0.398057, 0), #620 nm
    tm.vec3(0.83635, 0.385835, 0), #621 nm
    tm.vec3(0.81629, 0.373951, 0), #622 nm
    tm.vec3(0.79605, 0.362311, 0), #623 nm
    tm.vec3(0.77561, 0.350863, 0), #624 nm
    tm.vec3(0.75493, 0.339554, 0), #625 nm
    tm.vec3(0.73399, 0.328309, 0), #626 nm
    tm.vec3(0.71278, 0.317118, 0), #627 nm
    tm.vec3(0.69129, 0.305936, 0), #628 nm
    tm.vec3(0.66952, 0.294737, 0), #629 nm
    tm.vec3(0.647467, 0.283493, 0), #630 nm
    tm.vec3(0.62511, 0.272222, 0), #631 nm
    tm.vec3(0.60252, 0.26099, 0), #632 nm
    tm.vec3(0.57989, 0.249877, 0), #633 nm
    tm.vec3(0.55737, 0.238946, 0), #634 nm
    tm.vec3(0.53511, 0.228254, 0), #635 nm
    tm.vec3(0.51324, 0.217853, 0), #636 nm
    tm.vec3(0.49186, 0.20778, 0), #637 nm
    tm.vec3(0.47108, 0.198072, 0), #638 nm
    tm.vec3(0.45096, 0.188748, 0), #639 nm
    tm.vec3(0.431567, 0.179828, 0), #640 nm
    tm.vec3(0.41287, 0.171285, 0), #641 nm
    tm.vec3(0.39475, 0.163059, 0), #642 nm
    tm.vec3(0.37721, 0.155151, 0), #643 nm
    tm.vec3(0.36019, 0.147535, 0), #644 nm
    tm.vec3(0.34369, 0.140211, 0), #645 nm
    tm.vec3(0.32769, 0.13317, 0), #646 nm
    tm.vec3(0.31217, 0.1264, 0), #647 nm
    tm.vec3(0.29711, 0.119892, 0), #648 nm
    tm.vec3(0.2825, 0.11364, 0), #649 nm
    tm.vec3(0.268329, 0.107633, 0), #650 nm
    tm.vec3(0.25459, 0.10187, 0), #651 nm
    tm.vec3(0.2413, 0.096347, 0), #652 nm
    tm.vec3(0.22848, 0.091063, 0), #653 nm
    tm.vec3(0.21614, 0.08601, 0), #654 nm
    tm.vec3(0.2043, 0.081187, 0), #655 nm
    tm.vec3(0.19295, 0.076583, 0), #656 nm
    tm.vec3(0.18211, 0.072198, 0), #657 nm
    tm.vec3(0.17177, 0.068024, 0), #658 nm
    tm.vec3(0.16192, 0.064052, 0), #659 nm
    tm.vec3(0.152568, 0.060281, 0), #660 nm
    tm.vec3(0.14367, 0.056697, 0), #661 nm
    tm.vec3(0.1352, 0.053292, 0), #662 nm
    tm.vec3(0.12713, 0.050059, 0), #663 nm
    tm.vec3(0.11948, 0.046998, 0), #664 nm
    tm.vec3(0.11221, 0.044096, 0), #665 nm
    tm.vec3(0.10531, 0.041345, 0), #666 nm
    tm.vec3(0.098786, 0.0387507, 0), #667 nm
    tm.vec3(0.09261, 0.0362978, 0), #668 nm
    tm.vec3(0.086773, 0.0339832, 0), #669 nm
    tm.vec3(0.0812606, 0.0318004, 0), #670 nm
    tm.vec3(0.076048, 0.0297395, 0), #671 nm
    tm.vec3(0.071114, 0.0277918, 0), #672 nm
    tm.vec3(0.066454, 0.0259551, 0), #673 nm
    tm.vec3(0.062062, 0.0242263, 0), #674 nm
    tm.vec3(0.05793, 0.0226017, 0), #675 nm
    tm.vec3(0.05405, 0.0210779, 0), #676 nm
    tm.vec3(0.050412, 0.0196505, 0), #677 nm
    tm.vec3(0.047006, 0.0183153, 0), #678 nm
    tm.vec3(0.043823, 0.0170686, 0), #679 nm
    tm.vec3(0.0408508, 0.0159051, 0), #680 nm
    tm.vec3(0.038072, 0.0148183, 0), #681 nm
    tm.vec3(0.035468, 0.0138008, 0), #682 nm
    tm.vec3(0.033031, 0.0128495, 0), #683 nm
    tm.vec3(0.030753, 0.0119607, 0), #684 nm
    tm.vec3(0.028623, 0.0111303, 0), #685 nm
    tm.vec3(0.026635, 0.0103555, 0), #686 nm
    tm.vec3(0.024781, 0.0096332, 0), #687 nm
    tm.vec3(0.023052, 0.0089599, 0), #688 nm
    tm.vec3(0.021441, 0.0083324, 0), #689 nm
    tm.vec3(0.0199413, 0.0077488, 0), #690 nm
    tm.vec3(0.018544, 0.0072046, 0), #691 nm
    tm.vec3(0.017241, 0.0066975, 0), #692 nm
    tm.vec3(0.016027, 0.0062251, 0), #693 nm
    tm.vec3(0.014896, 0.005785, 0), #694 nm
    tm.vec3(0.013842, 0.0053751, 0), #695 nm
    tm.vec3(0.012862, 0.0049941, 0), #696 nm
    tm.vec3(0.011949, 0.0046392, 0), #697 nm
    tm.vec3(0.0111, 0.0043093, 0), #698 nm
    tm.vec3(0.010311, 0.0040028, 0), #699 nm
    tm.vec3(0.00957688, 0.00371774, 0), #700 nm
    tm.vec3(0.008894, 0.00345262, 0), #701 nm
    tm.vec3(0.0082581, 0.00320583, 0), #702 nm
    tm.vec3(0.0076664, 0.00297623, 0), #703 nm
    tm.vec3(0.0071163, 0.00276281, 0), #704 nm
    tm.vec3(0.0066052, 0.00256456, 0), #705 nm
    tm.vec3(0.0061306, 0.00238048, 0), #706 nm
    tm.vec3(0.0056903, 0.00220971, 0), #707 nm
    tm.vec3(0.0052819, 0.00205132, 0), #708 nm
    tm.vec3(0.0049033, 0.00190449, 0), #709 nm
    tm.vec3(0.00455263, 0.00176847, 0), #710 nm
    tm.vec3(0.0042275, 0.00164236, 0), #711 nm
    tm.vec3(0.0039258, 0.00152535, 0), #712 nm
    tm.vec3(0.0036457, 0.00141672, 0), #713 nm
    tm.vec3(0.0033859, 0.00131595, 0), #714 nm
    tm.vec3(0.0031447, 0.00122239, 0), #715 nm
    tm.vec3(0.0029208, 0.00113555, 0), #716 nm
    tm.vec3(0.002713, 0.00105494, 0), #717 nm
    tm.vec3(0.0025202, 0.00098014, 0), #718 nm
    tm.vec3(0.0023411, 0.00091066, 0), #719 nm
    tm.vec3(0.00217496, 0.00084619, 0), #720 nm
    tm.vec3(0.0020206, 0.00078629, 0), #721 nm
    tm.vec3(0.0018773, 0.00073068, 0), #722 nm
    tm.vec3(0.0017441, 0.00067899, 0), #723 nm
    tm.vec3(0.0016205, 0.00063101, 0), #724 nm
    tm.vec3(0.0015057, 0.00058644, 0), #725 nm
    tm.vec3(0.0013992, 0.00054511, 0), #726 nm
    tm.vec3(0.0013004, 0.00050672, 0), #727 nm
    tm.vec3(0.0012087, 0.00047111, 0), #728 nm
    tm.vec3(0.0011236, 0.00043805, 0), #729 nm
    tm.vec3(0.00104476, 0.00040741, 0), #730 nm
    tm.vec3(0.00097156, 0.000378962, 0), #731 nm
    tm.vec3(0.0009036, 0.000352543, 0), #732 nm
    tm.vec3(0.00084048, 0.000328001, 0), #733 nm
    tm.vec3(0.00078187, 0.000305208, 0), #734 nm
    tm.vec3(0.00072745, 0.000284041, 0), #735 nm
    tm.vec3(0.0006769, 0.000264375, 0), #736 nm
    tm.vec3(0.00062996, 0.000246109, 0), #737 nm
    tm.vec3(0.00058637, 0.000229143, 0), #738 nm
    tm.vec3(0.00054587, 0.000213376, 0), #739 nm
    tm.vec3(0.000508258, 0.00019873, 0), #740 nm
    tm.vec3(0.0004733, 0.000185115, 0), #741 nm
    tm.vec3(0.0004408, 0.000172454, 0), #742 nm
    tm.vec3(0.00041058, 0.000160678, 0), #743 nm
    tm.vec3(0.00038249, 0.00014973, 0), #744 nm
    tm.vec3(0.00035638, 0.00013955, 0), #745 nm
    tm.vec3(0.00033211, 0.000130086, 0), #746 nm
    tm.vec3(0.00030955, 0.00012129, 0), #747 nm
    tm.vec3(0.00028858, 0.000113106, 0), #748 nm
    tm.vec3(0.00026909, 0.000105501, 0), #749 nm
    tm.vec3(0.000250969, 0.000098428, 0), #750 nm
    tm.vec3(0.00023413, 0.000091853, 0), #751 nm
    tm.vec3(0.00021847, 0.000085738, 0), #752 nm
    tm.vec3(0.00020391, 0.000080048, 0), #753 nm
    tm.vec3(0.00019035, 0.000074751, 0), #754 nm
    tm.vec3(0.00017773, 0.000069819, 0), #755 nm
    tm.vec3(0.00016597, 0.000065222, 0), #756 nm
    tm.vec3(0.00015502, 0.000060939, 0), #757 nm
    tm.vec3(0.0001448, 0.000056942, 0), #758 nm
    tm.vec3(0.00013528, 0.000053217, 0), #759 nm
    tm.vec3(0.00012639, 0.000049737, 0), #760 nm
    tm.vec3(0.0001181, 0.000046491, 0), #761 nm
    tm.vec3(0.00011037, 0.000043464, 0), #762 nm
    tm.vec3(0.00010315, 0.000040635, 0), #763 nm
    tm.vec3(0.000096427, 0.000038, 0), #764 nm
    tm.vec3(0.000090151, 0.0000355405, 0), #765 nm
    tm.vec3(0.000084294, 0.0000332448, 0), #766 nm
    tm.vec3(0.00007883, 0.0000311006, 0), #767 nm
    tm.vec3(0.000073729, 0.000029099, 0), #768 nm
    tm.vec3(0.000068969, 0.0000272307, 0), #769 nm
    tm.vec3(0.0000645258, 0.000025486, 0), #770 nm
    tm.vec3(0.000060376, 0.0000238561, 0), #771 nm
    tm.vec3(0.0000565, 0.0000223332, 0), #772 nm
    tm.vec3(0.00005288, 0.0000209104, 0), #773 nm
    tm.vec3(0.000049498, 0.0000195808, 0), #774 nm
    tm.vec3(0.000046339, 0.0000183384, 0), #775 nm
    tm.vec3(0.000043389, 0.0000171777, 0), #776 nm
    tm.vec3(0.000040634, 0.0000160934, 0), #777 nm
    tm.vec3(0.00003806, 0.00001508, 0), #778 nm
    tm.vec3(0.000035657, 0.0000141336, 0), #779 nm
    tm.vec3(0.0000334117, 0.000013249, 0), #780 nm
    tm.vec3(0.000031315, 0.0000124226, 0), #781 nm
    tm.vec3(0.000029355, 0.0000116499, 0), #782 nm
    tm.vec3(0.000027524, 0.0000109277, 0), #783 nm
    tm.vec3(0.000025811, 0.0000102519, 0), #784 nm
    tm.vec3(0.000024209, 0.0000096196, 0), #785 nm
    tm.vec3(0.000022711, 0.0000090281, 0), #786 nm
    tm.vec3(0.000021308, 0.000008474, 0), #787 nm
    tm.vec3(0.000019994, 0.0000079548, 0), #788 nm
    tm.vec3(0.000018764, 0.0000074686, 0), #789 nm
    tm.vec3(0.0000176115, 0.0000070128, 0), #790 nm
    tm.vec3(0.000016532, 0.0000065858, 0), #791 nm
    tm.vec3(0.000015521, 0.0000061857, 0), #792 nm
    tm.vec3(0.000014574, 0.0000058107, 0), #793 nm
    tm.vec3(0.000013686, 0.000005459, 0), #794 nm
    tm.vec3(0.000012855, 0.0000051298, 0), #795 nm
    tm.vec3(0.000012075, 0.0000048206, 0), #796 nm
    tm.vec3(0.000011345, 0.0000045312, 0), #797 nm
    tm.vec3(0.000010659, 0.0000042591, 0), #798 nm
    tm.vec3(0.000010017, 0.0000040042, 0), #799 nm
    tm.vec3(0.00000941363, 0.00000376473, 0), #800 nm
    tm.vec3(0.0000088479, 0.00000353995, 0), #801 nm
    tm.vec3(0.0000083171, 0.00000332914, 0), #802 nm
    tm.vec3(0.000007819, 0.00000313115, 0), #803 nm
    tm.vec3(0.0000073516, 0.00000294529, 0), #804 nm
    tm.vec3(0.000006913, 0.00000277081, 0), #805 nm
    tm.vec3(0.0000065015, 0.00000260705, 0), #806 nm
    tm.vec3(0.0000061153, 0.00000245329, 0), #807 nm
    tm.vec3(0.0000057529, 0.00000230894, 0), #808 nm
    tm.vec3(0.0000054127, 0.00000217338, 0), #809 nm
    tm.vec3(0.00000509347, 0.00000204613, 0), #810 nm
    tm.vec3(0.0000047938, 0.00000192662, 0), #811 nm
    tm.vec3(0.0000045125, 0.0000018144, 0), #812 nm
    tm.vec3(0.0000042483, 0.00000170895, 0), #813 nm
    tm.vec3(0.0000040002, 0.00000160988, 0), #814 nm
    tm.vec3(0.0000037671, 0.00000151677, 0), #815 nm
    tm.vec3(0.000003548, 0.00000142921, 0), #816 nm
    tm.vec3(0.0000033421, 0.00000134686, 0), #817 nm
    tm.vec3(0.0000031485, 0.00000126945, 0), #818 nm
    tm.vec3(0.0000029665, 0.00000119662, 0), #819 nm
    tm.vec3(0.00000279531, 0.00000112809, 0), #820 nm
    tm.vec3(0.0000026345, 0.00000106368, 0), #821 nm
    tm.vec3(0.0000024834, 0.00000100313, 0), #822 nm
    tm.vec3(0.0000023414, 0.00000094622, 0), #823 nm
    tm.vec3(0.0000022078, 0.00000089263, 0), #824 nm
    tm.vec3(0.000002082, 0.00000084216, 0), #825 nm
    tm.vec3(0.0000019636, 0.00000079464, 0), #826 nm
    tm.vec3(0.0000018519, 0.00000074978, 0), #827 nm
    tm.vec3(0.0000017465, 0.00000070744, 0), #828 nm
    tm.vec3(0.0000016471, 0.00000066748, 0), #829 nm
    tm.vec3(0.00000155314, 0.0000006297, 0), #830 nm
]


# Create And Convert List To Fields
CIE1964XYZ = ti.Vector.field(n=3, dtype=ti.f32, shape=(len(CIE1964XYZ_list)))
for i in range(len(CIE1964XYZ_list)):
    CIE1964XYZ[i] = CIE1964XYZ_list[i]


# Functions
@ti.func
def WaveToXYZ(wave):
    # Conversion From Wavelength To XYZ Using CIE1964 XYZ Table
    XYZ = tm.vec3(0.0, 0.0, 0.0)
    if wave >= 360 and wave <= 830:
        # Finding The Appropriate Index Of The Table For Given Wavelength
        index = int((ti.floor(wave) - 360))
        t1 = CIE1964XYZ[index]
        t2 = CIE1964XYZ[index + 1]
        # Interpolation To Make The Colors Smooth
        XYZ = tm.mix(t1, t2, (wave) - tm.floor(wave))
    return XYZ

# http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
@ti.func
def XYZToRGB(XYZ):
    # Conversion From XYZ To RGB Color Space Using Matrix
    m1 = tm.mat3([2.3706743, -0.9000405, -0.4706338], [-0.5138850, 1.4253036, 0.0885814], [0.0052982, -0.0146949, 1.0093968])
    m2 = tm.vec3(XYZ[0], XYZ[1], XYZ[2])
    return tm.vec3(m1 @ m2)

